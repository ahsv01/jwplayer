!function(){var e="googima",t="TYPE_API",i="TYPE_SCHEDULE",r="-1",n="jw-flag-ads-googleima",o="jw-flag-ads-vpaid",a="jw-flag-ads-vpaid-controls",s="playing",d="adBreakStart",l="adBreakEnd",u="adCompanions",g="adError",c="adStarted",p=2e3;function h(e,t,i){if(!e)return e;for(var r=t.getPlaylistItem(),n=t.getConfig(),o=e.replace("__random-number__",Math.random()*Math.pow(10,18)).replace("__timestamp__",(new Date).getTime()).replace("__page-url__",encodeURIComponent(window.location.href)).replace("__referrer__",encodeURIComponent(document.referrer)).replace("__player-height__",t.getHeight()||n.height).replace("__player-width__",t.getWidth()||n.width).replace("__item-duration__",function(e,t){var i=Math.pow(10,t);return Math.round(e*i)/i}(t.getDuration(),3)).replace("__domain__",encodeURIComponent(function(){var e=window.location.href.match(new RegExp(/^[^/]*:\/\/\/?([^/]*)/));return e&&e.length>1?e[1]:""}())),a=(o=i.companiondiv&&i.companiondiv.id?o.replace("__companion-div__",i.companiondiv.id):o.replace("__companion-div__","")).match(new RegExp(/__item-[a-z 0-9 A-Z]*__/g)),s=0;a&&s<a.length;s++){var d=a[s],l=d.substring(7,d.length-2);if(r.hasOwnProperty(l)&&t._.isString(r[l])){var u=r[l];u.length>1e3&&(u=u.substring(0,1e3)),o=o.replace(d,encodeURIComponent(u))}else o=o.replace(d,"")}if(r.title&&-1===o.indexOf("vid_t=")){var g=r.title.substring(0,100).replace(/[^\x00-\x7F]/g,"");o+=(c=o,(-1!==c.indexOf("?")?"&":"?")+"vid_t="+encodeURIComponent(g))}var c;return o}var f=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")};function m(e,t,i){if("start"===e||"0%"===e)return"pre";if("end"===e||"100%"===e)return"post";if("pre"===e||"post"===e||i.indexOf(e,"%")>-1)return e;var r=t.seconds(e);return!!i.isNumber(r)&&r}function y(e,t,i){var r=m(e,t,i);return r||(r="pre"),i.isNumber(r)&&(r=function(e){var t=parseInt(e,10),i=Math.floor(t)%1e3,r=Math.floor(t/1e3)%60,n=Math.floor(t/6e4)%60,o=Math.floor(t/36e5)%24;return(o=o<10?"0"+o:o)+":"+(n=n<10?"0"+n:n)+":"+(r=r<10?"0"+r:r)+"."+(i=("000"+i).slice(-3))}(1e3*r)),r}function v(e,t,i){if(!i)return e;var r=e.indexOf("?")>=0?"&":"?",n="cust_params=",o=e.indexOf(n),a=n.length,s="",d="";if(t.foreach(i,function(e,t){s=""+s+d+e+"="+t,d="&"}),s=encodeURIComponent(s),o>=0){var l=e.substr(0,o+a),u=e.substr(o+a);return""+l+s+"%26"+u}return""+e+r+"cust_params="+s}function b(e,t,i){var r={};return t.foreach(e,function(e,n){var o={},a=n.ad||n;o.offset=y(a.offset||a.position||n.offset||"",t,i),o.tag=v(a.tag,t,a.custParams),o.type=a.type||n.type||"linear,nonlinear",r[e]=o}),r}var w=function(){function e(t,i){f(this,e),this.player=t,this.options=i}return e.prototype.getAdsResponse=function(e){var t=this,i=this.player,r=i.utils,n='<vmap:AdBreak breakType="_type_" breakId="_adbreakname_" timeOffset="_offset_"><vmap:AdSource allowMultipleAds="true" followRedirects="true" id="_adbreakname_-ad-1"><vmap:AdTagURI><![CDATA[_url_]]></vmap:AdTagURI></vmap:AdSource></vmap:AdBreak>',o=[],a=[],s=[];return r.foreach(b(e,r,i._),function(e,r){var d=r.offset.replace("pre","start").replace("post","end"),l=n.replace(/_type_/g,r.type).replace(/_adbreakname_/g,e).replace(/_offset_/g,d).replace(/_url_/g,h(r.tag,i,t.options,r.custParams));"start"===d?o.push(l):"end"===d?s.push(l):a.push(l)}),'<vmap:VMAP xmlns:vmap="http://www.iab.net/videosuite/vmap" version="1.0">'+o.join("")+a.join("")+s.join("")+"</vmap:VMAP>"},e.prototype.getTagMap=function(e){var t=this,i=this.player,r=i.utils,n={};return r.foreach(b(e,r,i._),function(e,o){var a=m(o.offset,r,i._);i._.isString(a)&&(a=parseFloat(a.replace("pre","0").replace("post","-1"))),i._.isNumber(a)&&(n[a]=h(o.tag,i,t.options))}),n},e.prototype.getTagList=function(e){var t=this,i=this.player,r=i.utils,n=[];return r.foreach(b(e,r,i._),function(e,o){var a=m(o.offset,r,i._);i._.isString(a)&&(a=parseFloat(a.replace("pre","0").replace("post","-1"))),n.push({offset:a,tag:h(o.tag,i,t.options)})}),n},e}(),A={adcountercountkey:"__AD_POD_CURRENT__",adcounterdynamic:"Ad __AD_POD_CURRENT__ of __AD_POD_LENGTH__. ",adcountertotalkey:"__AD_POD_LENGTH__",admessage:"This ad will end in xx",admessagedynamickey:"xx",admessagestatic:"This is an Advertisement",advideoheight:0,advideowidth:0,allowadskip:!1,allowadskippastseconds:0,allowplayercontrols:!1,allowvolumeslider:!1,autoplayadsmuted:!1,click_tracking:!0,companiondiv:null,companionResourceType:"",cuetext:"Advertisement",debug:!1,enablePreloading:!1,invertmutebutton:!1,loadVideoTimeout:15e3,locale:"",maxRedirects:-1,overlayslotheight:0,overlayslotwidth:0,premiumAds:!1,requestTimeout:1e4,scaled_ads:!0,usestaticmessage:!1,vastLoadTimeout:1e4,vpaidcontrols:!1,vpaidmode:"insecure"};function E(e){if("true"===e)return!0;if("false"===e)return!1;var t=parseFloat(e);return isNaN(t)?e:t}var P=function(){function e(t,i){f(this,e),this.config=t,this.utils=i,this.bidsResponse={};for(var r in A)if(A.hasOwnProperty(r)){var n=t[r],o=A[r],a=typeof o;if(void 0!==n){if("boolean"!==a&&"number"!==a||(n=E(n)),typeof n!==a)throw new Error("invalid parameter: "+r+" should be a "+a);this[r]=n}else this[r]=o}this.admessagedynamic=this.admessage}return e.prototype.getSingleTagPrerollBlock=function(){var e=this.getConfigSchedule(),t=this.singleTagBidsResponse;if("string"==typeof e){if(!t)return e;var i=t.custParams;return v(t.tag,this.utils,i)}return null},e.prototype.addBidsResponse=function(e,t){var i=void 0;i=e&&!e.error&&(e.bidWon||e.tag)?e:null,t?this.bidsResponse[t]=i:this.singleTagBidsResponse=i},e.prototype.getSchedule=function(){var e=this,t=this.getConfigSchedule();if(!t)return t;var i=this.utils.extend({},t),r=this.getSingleTagPrerollBlock();return r||Object.keys(this.bidsResponse).reduce(function(t,i){var r=t[i],n=e.bidsResponse[i];return r&&n&&(t[i]=Object.assign({},r,{tag:n.tag,custParams:Object.assign({},r.custParams,n.custParams)})),t},i)},e.prototype.getConfigSchedule=function(){var e=this.config;return e.tag||this.adschedule||e.schedule||e.ad},e.prototype.getAdRules=function(){var e=this.config.rules||{};return{startOn:e.startOn||1,frequency:void 0!==e.frequency?e.frequency:1}},e}(),C=function(){function e(t,i,r){f(this,e);var n=document.createElement("div");this.visible=!1,this.style=r,this.div=t,this.adDiv=n,n.id=i+"_ad",r(t,{overflow:"hidden",width:"100%",height:"100%",display:"block",visibility:"hidden",pointerEvents:"none",opacity:0}),r(n,{position:"absolute",width:"100%",height:"100%"}),t.appendChild(n)}return e.prototype.resizeNonLinear=function(e,t){this.style(this.div,{height:t+"px",top:"auto",width:"100%"})},e.prototype.resizeLinear=function(){this.style(this.div,{top:"0px",left:"0px",width:"100%",height:"100%"})},e.prototype.getAdDiv=function(){return this.adDiv},e.prototype.adSetup=function(){this.visible=!0,this.style(this.div,{visibility:"visible",display:"block",pointerEvents:"all",opacity:1},!0);for(var e=this.adDiv.childNodes,t=0;t<e.length;t++){var i=e[t];("DIV"!==i.tagName||i.hasChildNodes())&&this.style(i,{width:"100%",height:"100%"})}},e.prototype.adTakeDown=function(){this.visible=!1,this.style(this.div,{visibility:"hidden",pointerEvents:"none",opacity:0});for(var e=this.adDiv.childNodes,t=0;t<e.length;t++)this.style(e[t],{width:"",height:""})},e}(),_=null,L=-1;function j(){return L}function M(e){if(_)return _;if(window.google&&google.ima&&google.ima.AdDisplayContainer)return _=Promise.resolve();var t=["//","imasdk.googleapis.com/js/sdkloader/ima3.js"];"file:"===document.location.protocol&&t.unshift("https:");var i=new e.scriptloader(t.join(""));return _=i.load().then(function(){L=Date.now()})}var S={};function T(e,t){var i=this,r=S[t];if(r)return r;this.jwplayerEntitlements=function(e,t,i){var r={canPlayAds:!0},n=new e.key(t),o=n.edition();if("unlimited"===o)return i(r);var a=n.token(),s=["//","entitlements.jwplayer.com","/",a,".json"];"file:"===window.location.protocol&&s.unshift("https:"),e.ajax(s.join(""),function(e){r.canPlayAds=!e||!e.response||!1!==e.response.canPlayAds,i(r)},function(){i(r)},{timeout:1e4,responseType:"json"})};return S[t]=new Promise(function(r,n){i.jwplayerEntitlements(e,t,function(e){e.canPlayAds?r():n({message:"Ad Limit Reached"})})})}var I,k=function(){function e(t,i,r){f(this,e),t.extend(this,i),this.vol=0,this.imaProxy=null,this.view=r}return e.prototype.setProxy=function(e){this.imaProxy=e,"boolean"==typeof this.muted&&this.mute(this.muted)},e.prototype.attachMedia=function(){},e.prototype.detachMedia=function(){},e.prototype.mute=function(e){this.muted=e,this.imaProxy&&(e?this.imaProxy.setVolume(0):this.vol&&this.imaProxy.setVolume(this.vol)),this.muteAllAdContainerVideo(e)},e.prototype.muteAllAdContainerVideo=function(e){for(var t=this.view.getAdDiv().getElementsByTagName("video"),i=0;i<t.length;i++)t[i].muted=e},e.prototype.volume=function(e){this.vol=e/100,this.imaProxy&&this.imaProxy.setVolume(this.vol)},e}(),R=2e3,D=2e3,x="usd",O=1,B="//c.amazon-adsystem.com/aax2/apstag.js",q="video",U="2962993",N="//js-sec.indexww.com/htv/htv-jwplayer.min.js",V="//js.spotx.tv/directsdk/v1/",W="//search.spotxchange.com/ad/vast.html?key=",G="dfp",z="jwp",J="jwpspotx",F="jwpdfp",H=z,X="APS",K="Index",Q="SpotX",Y=(I={},I[[G]]=[X,"FAN",K,Q],I[[z]]=["FAN",Q],I[[F]]=[Q],I[[J]]=[Q],I),Z="bid",$="error",ee="invalid",te="noBid",ie=Date.now||function(){return(new Date).getTime()};function re(e,t){return new Promise(function(i,r){setTimeout(r,t);var n=document.createElement("script");n.onload=n.onreadystatechange=function(e){this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(i(e),n.onload=n.onreadystatechange=null,o&&n.parentNode&&o.removeChild(n))},n.onerror=r,n.type="text/javascript",n.charset="utf-8",n.async=!0,n.timeout=t,n.src=e;var o=document.getElementsByTagName("head")[0]||document.documentElement;o.insertBefore(n,o.firstChild)}).catch(function(){return Promise.reject("Error loading script")})}var ne=encodeURIComponent(window.location.href),oe={requestBids:function(e,t,i){var r=e.id,n=(o=r,a=t.playerWidth,s=t.playerHeight,["https://an.facebook.com/v2/placementbid.json?&placementids[]="+o,"&playerwidth="+a,"&playerheight="+s,"&adformats[]="+q,"&sdk="+U,"&pageurl="+ne].join(""));var o,a,s;if(!function(e,t,i,r){if(!r)return!1;return e===G||t&&i===x}(t.mediationLayerAdServer,t.floorPriceCents,t.floorPriceCurrency||x,n))return Promise.resolve({result:ee,message:"Invalid configuration"});return new Promise(function(e){var t=new XMLHttpRequest;t.onreadystatechange=function(){4===this.readyState&&(e(this),t=null)},t.open("GET",n),t.withCredentials=!0,t.send(null),i.then(function(){t&&(t.abort(),t=null)})}).then(function(e){if(200!==e.status)return{result:$,message:"Invalid response (status "+e.status+")"};var i=JSON.parse(e.responseText),n=i.errors;if(n&&n.length)return{result:$,message:n[0]};var o=i.bids;if(!o||!o[r]||!o[r][0])return{result:te,message:"No bids for placement id"};var a=o[r][0],s=a.bid_price_cents,d=a.bid_id;if(t.mediationLayerAdServer===G)return{result:Z,tag:t.tag,custParams:{jwFANBidPrice:Math.round(s/100),jwFANBidID:d}};var l={result:Z,priceInCents:s,priceCurrency:a.bid_price_currency};s>=t.floorPriceCents&&(l.tag=(u=r,g=d,c=t.playerWidth,p=t.playerHeight,["https://an.facebook.com/v1/instream/vast.xml?placementid="+u,"&playerwidth="+c,"&playerheight="+p,"&sdk="+U,"&bidid="+g,"&pageurl="+ne].join("")));var u,g,c,p;return l}).catch(function(e){return{result:$,message:"FAN header bidding failed: "+e}})},getCustomResponse:function(){return{}}};var ae=null;function se(){return null===ae&&(ae=Promise.resolve(window.apstag).then(function(e){if(e&&e.init&&e.fetchBids)return e;return re(["file"===document.location.protocol?"https:":"",B].join(""),D).then(function(){return window.apstag})}).catch(function(e){throw ae=null,e})),ae}var de={requestBids:function(e,t){if(!e.id||!e.slotID)return Promise.resolve({result:ee,message:"Missing id or slotID in configuration"});return se().then(function(i){return i.init({id:e.pubId,adServer:e.adServer}),new Promise(function(r){i.fetchBids({slots:[{slotID:e.slotID}],timeout:t.bidTimeout},r)})}).then(function(i){return i&&i[0]&&i[0].slotID===e.slotID?{result:Z,tag:t.tag,custParams:{amznbid:i[0].amznbid,amzniid:i[0].amzniid}}:{result:te,message:"No bids for pubID and slotID"}}).catch(function(e){return{result:$,message:"Amazon header bidding failed: "+e}})},getCustomResponse:function(){return{}}};var le=null,ue=null;function ge(e){if(null===ue){var t=ie(),i=le||window.SpotX;if(i&&i.DirectAdOS)return ue=Promise.resolve({SpotX:i,loadingTime:ie()-t});var r=["file"===document.location.protocol?"https:":"",V,e,".js"].join("");(ue="function"==typeof require?(n=r,o=D,new Promise(function(e,t){setTimeout(t,o),require([n],e,t)}).catch(function(){return Promise.reject("Error loading script")})).then(function(e){return{SpotX:le=e,loadingTime:ie()-t}}):re(r,D).then(function(){return{SpotX:window.SpotX,loadingTime:ie()-t}})).catch(function(e){throw ue=null,e})}var n,o;return ue}var ce=void 0,pe={requestBids:function(e,t){if(!e.id)return Promise.resolve({result:ee,message:"Missing id in configuration"});var i=Object.assign({channel_id:e.id,slot:t.playerContainer,content_width:t.playerWidth,content_height:t.playerHeight,player_vendor:"SpotXJW",player_vendor_id:t.playerId,ad_volume:t.adVolume,autoplay:t.autoplay,blocked_autoplay_override_mode:t.autoplayAdsMuted,start_delay:function(e){if("start"===e||"0%"===e||!e||"pre"===e||"00:00:00"===e)return 0;if("end"===e||"100%"===e||"post"===e)return-2;if("string"==typeof e&&e.indexOf("%")>=0)return-1;var t=parseInt(e);return t>0?t:-1}(t.offset),placement:1,hide_skin:!0},e.optionalParams);e.passFloorPrice&&t.floorPriceCents&&(i.price_floor=t.floorPriceCents/100);return ge(e.id).then(function(e){var t=e.SpotX,r=e.loadingTime;ce=r;var n=new t.DirectAdOS(i),o=ie();return n.getAdServerKVPs().then(function(e){return{response:e,bidNetworkStartTime:o}})}).then(function(e){var i=e.response,r=e.bidNetworkStartTime,n=ie()-r,o=i.spotx_ad_key,a={spotx_bid:i.spotx_bid,spotx_ad_key:o},s=100*parseFloat(i.spotx_bid),d={result:Z,priceInCents:s,custParams:a,scriptLoadingTime:ce,bidNetworkResponseTime:n};if(t.mediationLayerAdServer===G)return d;var l=["file:"===document.location.protocol?"https:":"",W,o].join("");return Object.assign(d,{tag:l,tagKey:o})}).catch(function(e){return"SpotX :: Unable to find ad"===e.message?{result:te,message:e.message,scriptLoadingTime:ce}:{result:$,message:"SpotX header bidding failed: "+e,scriptLoadingTime:ce}})},getCustomResponse:function(){return{scriptLoadingTime:ce}}};var he=null;function fe(e){return null===he&&(he=Promise.resolve(window.indexapi).then(function(t){if(t)return t;return re(["file"===document.location.protocol?"https:":"",e||N].join(""),D).then(function(){return window.indexapi})}).catch(function(e){throw he=null,e})),he}var me={requestBids:function(e,t){if(!e.id&&!e.script)return Promise.resolve({result:ee,message:"Missing id or script in configuration"});var i=Object.assign({videoCommonArgs:{protocols:[2,3,5,6],mimes:["video/mp4","video/webm","application/javascript"],apiList:[1,2]},siteID:e.id},e);return fe().then(function(e){return new Promise(function(r){e.deferQueue=e.deferQueue||[],e.deferQueue.push(function(){e.solicitIndexVideoAds(t.tag,function(e,t){r({updatedTag:e,indexTargeting:t})},i)})})}).then(function(e){var i=e.indexTargeting;return void 0!==i?{result:Z,tag:t.tag,custParams:i}:{result:te,message:"No bids for site id"}}).catch(function(e){return{result:$,message:"Index Exchange header bidding failed: "+e}})},getCustomResponse:function(){return{}}};var ye,ve=(ye={},ye[[X]]=de,ye[["FAN"]]=oe,ye[[K]]=me,ye[[Q]]=pe,ye);var be=function(){function e(){var t=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=i.settings,n=void 0===r?{}:r,o=i.bidders,a=void 0===o?[]:o,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};f(this,e),this.settings=function(e,t){var i=Object.assign({bidTimeout:R,offset:"",playerContainer:t.container,playerHeight:t.height||0,playerWidth:t.width||0,tag:""},t,e);return Y[i.mediationLayerAdServer]||(i.mediationLayerAdServer=H),i.mediationLayerAdServer===J&&(i.floorPriceCents=O),i}(n,s),this.bidders=(d=a,d.reduce(function(e,t){return t.name&&(e[t.name]=Object.assign(t,t.custom_params)),e},{}));var d;if("pre"!==this.settings.offset&&0!==parseInt(this.settings.offset)){var l;this.bidders=this.bidders[Q]?(l={},l[[Q]]=this.bidders[Q],l):{}}this.bidders[X]&&this.bidders[X].id&&this.bidders[X].slotID&&se(),this.bidders[K]&&(this.bidders[K].script||this.bidders[K].id)&&fe(this.bidders[K].script),this.bidders[Q]&&this.bidders[Q].id&&ge(this.bidders[Q].id),this._bidRequest=null,this._currentTimeout=null,this._onCancelTrigger=null,this.onCancel=new Promise(function(e){t._onCancelTrigger=e})}return e.prototype.start=function(){return this._bidRequest||(this._bidRequest=function(e){var t=e.config,i=e.settings,r=e.onCancel,n=Y[i.mediationLayerAdServer].filter(function(e){return t[e]}).map(function(e){var n=ie();return Promise.race([ve[e].requestBids(t[e],i,r),r]).then(function(i){var r=ve[e].getCustomResponse();return Object.assign({},t[e],i,r,{timeForBidResponse:ie()-n|0})})});return Promise.all(n).then(function(e){var t=i.mediationLayerAdServer===G||i.mediationLayerAdServer===F,r=i.mediationLayerAdServer===z||i.mediationLayerAdServer===F||i.mediationLayerAdServer===J,n={priceInCents:i.floorPriceCents,timeForBidResponse:1/0},o=[],a={},s={};return s.bidders=e.map(function(e){return t||(e.winner=!1),e.result===Z&&(o.push(e),Object.assign(a,e.custParams),r&&(e.priceInCents>n.priceInCents||e.priceInCents===n&&e.timeForBidResponse<n.timeForBidResponse)&&(n=s.result=e)),e}),r&&n.name?(n.winner=!0,s):(t&&o.length&&(s.result={tag:i.tag,custParams:a}),s)})}({config:this.bidders,settings:this.settings,onCancel:this.onCancel})),this._bidRequest},e.prototype.stop=function(){var e=this;clearTimeout(this._currentTimeout),this._onCancelTrigger({result:"abort"}),this._bidRequest=null,this._currentTimeout=null,this._onCancelTrigger=null,this.onCancel=new Promise(function(t){e._onCancelTrigger=t})},e.prototype.getEventObject=function(e,t,i){var r=i.offset,n=this.settings.mediationLayerAdServer,o=t||[];"pre"!==r&&0!==parseInt(r)&&(o=o.filter(function(e){return e.name===Q}));var a={client:e,offset:r,mediationLayerAdServer:n,bidders:o,bidTimeout:this.settings.bidTimeout},s=this.settings.floorPriceCents;s&&n!==J&&n!==G&&(a.floorPriceCents=s);var d=this.settings.floorPriceCurrency;return d&&(a.floorPriceCurrency=d),a},e.prototype.then=function(e){return this._bidRequest?this._bidRequest.then(e,e):null},e.prototype.timeout=function(){clearTimeout(this._currentTimeout),this._currentTimeout=setTimeout(this._onCancelTrigger,this.settings.bidTimeout,{result:"timeout"})},e}();function we(t,i){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{type:t,client:e,adposition:null!==r?r:function(e){if(e.isBeforePlay()||0===e.getPosition())return"pre";if(e.isBeforeComplete()||e.getPosition()===e.getDuration())return"post";return"mid"}(i),viewable:i.getViewable()}}function Ae(t,i,r){var n=r.bidders,o=r.bids;if(!n)return t;var a=o.length?o[0]:null;if(a&&n.length){var s=a.getEventObject(e,n,{offset:t.adposition});t.mediationLayerAdServer=s.mediationLayerAdServer,t.bidders=s.bidders,s.floorPriceCents&&(t.floorPriceCents=s.floorPriceCents),"dfp"===t.mediationLayerAdServer&&("SpotXJW"===t.adsystem||i.indexOf("SpotXJW")>=0)&&t.bidders.forEach(function(e){e.winner="SpotX"===e.name})}return t}var Ee=function(){function t(e,i,r,n,o,a,s){f(this,t),r.utils.extend(this,r.Events),this.item=e,this.options=i,this.player=r,this.env=r.getEnvironment(),this.utils=r.utils,this.instreamProvider=n,this.view=o,this.initAdsManagerPromise=null,this.bidsPromise=null,this.blockingInstreamPlayer=null,this.currentAd=null,this.bidders=[],this.bids=[],this.timeoutAdStart=-1,this.progressIntervalId=-1,this.fullscreenIcon=r.getContainer().querySelector(".jw-icon-fullscreen"),this.adsLoaderManager=a,this.playbackProxy={currentTime:0,duration:0},this.video=s,this.isItemSchedule=!0,this.paused=!1,this.pausedByViewable=!1,this._qoe=new r.utils.Timer,this.debugConsoleLog=r.utils.noop,i.debug&&(this.debugConsoleLog=function(){var e;(e=console).log.apply(e,arguments)})}return t.prototype.startBid=function(t,i,r){var n=this,o=this.utils.extend({},t.config.bids),a=new be(o,{tag:i.tag,offset:i.offset,width:this.player.getWidth(),height:this.player.getHeight(),container:this.player.getContainer(),playerId:this.player.id,autoplay:this.player.getConfig().autostart,autoplayAdsMuted:t.autoplayadsmuted,adVolume:this.player.getVolume()});return this.bids.push(a),a.start(),this.trigger("adBidRequest",a.getEventObject(e,o.bidders,i)),a.then(function(o){if(n.trigger("adBidResponse",a.getEventObject(e,o.bidders,i)),n.bidders&&"pre"!==i.offset&&0!==parseInt(i.offset)||(n.bidders=o.bidders),n.destroyed())return null;t.addBidsResponse(o.result,r)})},t.prototype.init=function(e,t){var i=this;if(t.config.bids){var r=t.config.schedule||t.config.tag,n=[];"string"==typeof r?n.push(this.startBid(t,{tag:r,offset:"pre"})):Object.keys(r).forEach(function(e){n.push(i.startBid(t,r[e],e))}),this.bidsPromise=Promise.all(n)}else this.bidsPromise=Promise.resolve();this.initAdsManagerPromise=this.bidsPromise.then(M).then(function(){return i.destroyed()?null:(i.debugConsoleLog("[JW DEBUG] Open adsLoaderManager"),i.adsLoaderManager.open(e,t,i.player,i.options,i.video))}).then(function(e){if(i.destroyed())return null;var t=i.playbackProxy,r=i.adsLoaderManager,n=r.getAdsManager(e,t,i.options);i.instreamProvider.setProxy(n),i.muteInstreamProvider();var o=i.player.getSafeRegion(!1);if(i.debugConsoleLog("[JW DEBUG] adsManager init with",o.width,o.height,i.getViewMode()),n.init(o.width,o.height,i.getViewMode()),r.initializeDisplay(),r.bindEvents({LOADED:i.adLoaded.bind(i),AD_ERROR:i.adError.bind(i),CONTENT_PAUSE_REQUESTED:i.pauseRequested.bind(i),CONTENT_RESUME_REQUESTED:i.resumeRequested.bind(i),LOG:i.adLog.bind(i),STARTED:i.adStarted.bind(i),IMPRESSION:i.adImpression.bind(i),LINEAR_CHANGED:i.resize.bind(i),CLICK:i.adClick.bind(i),PAUSED:i.adPaused.bind(i),RESUMED:i.adResumed.bind(i),SKIPPED:i.adSkipped.bind(i),USER_CLOSE:i.adUserClose.bind(i),ALL_ADS_COMPLETED:i.allAdsCompleted.bind(i)}),i.isItemSchedule){var a=n.getCuePoints();if("string"==typeof r.schedule||a.length&&0===a[0]||(i.debugConsoleLog("[JW DEBUG] Stop blocking since there is no preroll"),i.stopBlocking()),a.length){var s=a.filter(function(e){return e>0}).map(function(e){return{begin:e,text:i.options.cuetext}});i.player.setCues(s)}}return n}).catch(function(e){throw i.asyncError&&i.asyncError(e),e})},t.prototype.getViewMode=function(){var e=google.ima.ViewMode;return this.player.getFullscreen()?e.FULLSCREEN:e.NORMAL},t.prototype.prepareToPlayAd=function(e){if(!this.destroyed())if(this.blockingInstreamPlayer){var t=e?"":this.player.getConfig().localization.loadingAd;this.blockingInstreamPlayer.setText(t)}else clearTimeout(this.timeoutAdStart),this.startBlocking(e)},t.prototype.muteInstreamProvider=function(){var e=this.video.muted||this.player.getMute();this.debugConsoleLog("[JW DEBUG] Setting mute on instreamProvider",e),this.instreamProvider.mute(e)},t.prototype.exitFullscreenOnInlineIOS=function(){if(this.env.OS.iOS){this.env.Browser.version.major<10||(this.debugConsoleLog("[JW DEBUG] Exiting fullscreen mode on iOS 10+"),this.player.setFullscreen(!1),this.utils.style(this.fullscreenIcon,{display:"none"}))}},t.prototype.startBlocking=function(e){var t=this;if(!this.blockingInstreamPlayer&&!this.destroyed()){this.debugConsoleLog("[JW DEBUG] JW Player startBlocking"),this.exitFullscreenOnInlineIOS(),this.options.premiumAds&&this.player.on("viewable",function(e){e.viewable?t.pausedByViewable&&(t.debugConsoleLog("[JW DEBUG] PremiumAds mode enabled. Start playing the ad on viewable"),t.player.play()):t.paused||(t.debugConsoleLog("[JW DEBUG] PremiumAds mode enabled. Pause the ad on not viewable"),t.player.pause(),t.pausedByViewable=!0)},this),this._qoe.tick("adLoading"),this.player.utils.addClass(this.player.getContainer(),n),this.adsLoaderManager&&this.adsLoaderManager.video&&(this.adsLoaderManager.video.blocked=!1),this.blockingInstreamPlayer=this.player.createInstream().init();var i=e?"":this.player.getConfig().localization.loadingAd;this.blockingInstreamPlayer.setText(i),this.blockingInstreamPlayer.applyProviderListeners(this.instreamProvider),this.initAdsManagerPromise.then(function(e){t.debugConsoleLog("[JW DEBUG] Start adsManager"),e.start()}).catch(this.utils.noop),clearTimeout(this.timeoutAdStart),this.timeoutAdStart=setTimeout(function(){if(t.debugConsoleLog("[JW DEBUG] Ad request timeout"),!t.destroyed()){t.asyncError=null,t.stopBlocking(),t.asyncDiscardAdBreak();var e={message:"Ad Request timeout after "+t.options.requestTimeout+" milliseconds",getErrorCode:function(){return 60004}},i=t.adsLoaderManager.adErrorEventObject(e,{});Ae(i,null,t),t.trigger(g,i)}},this.options.requestTimeout)}},t.prototype.stopBlocking=function(){this.destroyed()||(this.debugConsoleLog("[JW DEBUG] JW Player stopBlocking"),this.player.off("viewable",null,this),clearTimeout(this.timeoutAdStart),this.utils.style(this.fullscreenIcon,{display:""}),this.player.utils.removeClass(this.player.getContainer(),[o,a,n]),this.blockingInstreamPlayer&&(this.adsLoaderManager&&this.adsLoaderManager.video&&(this.adsLoaderManager.video.blocked=!0),this.instreamProvider.off(),this.blockingInstreamPlayer.destroy(),this.blockingInstreamPlayer=null,this.view.adTakeDown()))},t.prototype.pauseRequested=function(e){var t=this;this.prepareToPlayAd();var i=this.adsLoaderManager.adEventObject(e.getAd());this.player.trigger(d,we(d,this.player,i.adposition)),this.blockingInstreamPlayer.on("destroyed",function(){t.player.trigger(l,we(l,t.player,i.adposition))})},t.prototype.resumeRequested=function(){this.debugConsoleLog("[JW DEBUG] ResumeRequest from IMA SDK"),this.currentAd&&this.currentAd.isLinear()&&(this.finishAd(),this.view.adTakeDown()),this.stopBlocking()},t.prototype.finishAd=function(){this.currentAd&&(clearInterval(this.progressIntervalId),this.currentAd=null)},t.prototype.discardAdBreak=function(e){!e&&this.adsLoaderManager&&(e=this.adsLoaderManager.adsManager),!this.destroyed()&&e&&(e.discardAdBreak(),e.stop())},t.prototype.asyncDiscardAdBreak=function(){var e=this;this.initAdsManagerPromise.then(function(t){return e.discardAdBreak(t)}).catch(this.utils.noop)},t.prototype.pause=function(){this.pausedByViewable=!1;var e=this.adsLoaderManager.adsManager;e&&(this.debugConsoleLog("[JW DEBUG] JW Player pause ad"),e.pause())},t.prototype.resume=function(){this.pausedByViewable=!1;var e=this.adsLoaderManager.adsManager;e&&(this.debugConsoleLog("[JW DEBUG] JW Player resume ad"),e.resume())},t.prototype.beforePlay=function(e){var t=this;this.bids.map(function(e){e.timeout()}),this.player.off("beforePlay",null,this),this.isItemSchedule=!!e,this.prepareToPlayAd(this.isItemSchedule),this.adsLoaderManager.initializeDisplay({restrict:!0}),this._qoe.tick("adBeforePlay"),this.bidsPromise.then(M).then(function(){t.destroyed()||(t.debugConsoleLog("[JW DEBUG] Request ads to IMA SDK"),t.adsLoaderManager.requestAds())}).catch(this.utils.noop)},t.prototype.beforeComplete=function(){var e=this.adsLoaderManager.adsManager;e&&e.getCuePoints().indexOf(-1)>-1&&this.prepareToPlayAd(),this.adsLoaderManager.unbindEvents(["CONTENT_RESUME_REQUESTED"]),this.playbackProxy.currentTime=this.playbackProxy.duration,this.debugConsoleLog("[JW DEBUG] Call contentComplete on IMA SDK"),this.adsLoaderManager.contentComplete()},t.prototype.time=function(e){this.playbackProxy.currentTime=e.position,e.duration>=e.position?this.playbackProxy.duration=e.duration:this.playbackProxy.duration=1/0},t.prototype.resize=function(){var e=this.currentAd,t=this.adsLoaderManager.adsManager;if(t){var i=e&&!e.isLinear(),r=this.player.getSafeRegion(i);if(i){var n=e.getHeight();n=this.player.getFullscreen()?r.height/2:Math.max(100,n+10),this.debugConsoleLog("[JW DEBUG] Resize adsManager",r.width,n,this.getViewMode()),t.resize(r.width,n,this.getViewMode()),this.view.resizeNonLinear(r,n)}else this.debugConsoleLog("[JW DEBUG] Resize adsManager",r.width,r.height,this.getViewMode()),t.resize(r.width,r.height,this.getViewMode()),this.view.resizeLinear()}},t.prototype.triggerAdPlay=function(e,t,i,r){if(e.isLinear()){this.instreamProvider.trigger("state",{newstate:i,oldstate:r});var n=this.adsLoaderManager.adEventObject(e);n.oldstate=r,n.newstate=i,this.trigger(t,n)}},t.prototype.progressInterval=function(e,t){var i=this;if(clearInterval(this.progressIntervalId),t){var r=e.getAdId(),n=e.getAdPodInfo(),o=-1,a=this.options.admessage||"",s=new RegExp(this.options.admessagedynamickey,"g"),d=this.options.adcounterdynamic||"",l=new RegExp(this.options.adcountercountkey,"g"),u=new RegExp(this.options.adcountertotalkey,"g");this.progressIntervalId=setInterval(function(){if(i.currentAd&&i.currentAd.getAdId()===r){var g=t.getRemainingTime();if(!(isNaN(g)||g<=0)&&o!==g){o=g;var c=e.getDuration(),p=c-g;if(i.blockingInstreamPlayer){var h=a.replace(s,Math.round(c-p)),f=n.getTotalAds();if(f>1){var m=n.getAdPosition();h=d.replace(l,m).replace(u,f)+"  "+h}i.blockingInstreamPlayer.setText(h),i.instreamProvider.trigger("time",{duration:c,position:p})}if(c>0){var y=i.adsLoaderManager.adEventObject(e);y.position=p,y.duration=c,i.trigger("adTime",y)}}}else clearInterval(i.progressIntervalId)},250)}},t.prototype.adLoaded=function(e){this.muteInstreamProvider();var t=this.adsLoaderManager.adEventObject(e.getAd());this.trigger("adRequest",t)},t.prototype.adStarted=function(e){this.paused=!1;var t=e.getAd(),i=this.adsLoaderManager.adEventObject(t);this.trigger(c,i)},t.prototype.adImpression=function(e){var t=this,i=e.getAd(),r=i.isLinear(),n=r&&(i.getContentType().indexOf("image")>=0||-1===i.getDuration()),d=i.getContentType(),l="application/javascript"===d||"application/x-shockwave-flash"===d,u=r&&l&&this.options.vpaidcontrols;this.currentAd=i,this.blockingInstreamPlayer&&this.blockingInstreamPlayer.setSkipOffset(i.getSkipTimeOffset()),this.adsLoaderManager.bindEvents({COMPLETE:this.adComplete.bind(this)}),l&&this.env.OS.mobile&&this.options.autoplayadsmuted&&this.adsLoaderManager.bindEvents({VOLUME_CHANGED:function(){t.adsLoaderManager.unbindEvents(["VOLUME_CHANGED"]),t.player.setMute(!!t.adsLoaderManager.adsManager.getVolume())}}),n?this.startBlocking():r||this.stopBlocking(),this.player.utils.toggleClass(this.player.getContainer(),o,r&&(n||l)),this.player.utils.toggleClass(this.player.getContainer(),a,u),this.view.adSetup(),this.resize(),this.muteInstreamProvider(),clearTimeout(this.timeoutAdStart);var g=this.adsLoaderManager.adsManager;this.progressInterval(i,g);var c=this.adsLoaderManager.adEventObject(i);"pre"!==c.adposition||void 0!==c.podcount&&1!==c.sequence||(this._qoe.tick("adImpression"),c.timeLoading=this._qoe.between("adBeforePlay","adImpression")),Ae(c,i.getWrapperAdSystems(),this),this.trigger("adImpression",c),this.triggerAdPlay(i,"adPlay",s,"buffering")},t.prototype.adComplete=function(e){this.finishAd();var t=e.getAd(),i=this.adsLoaderManager.adEventObject(t);this.trigger("adComplete",i),this.adsLoaderManager.unbindEvents(["VOLUME_CHANGED"])},t.prototype.adClick=function(e){var t=this.adsLoaderManager.adsManager,i=e.getAd(),r=i.getContentType();"application/javascript"===r||"application/x-shockwave-flash"===r||(this.debugConsoleLog("[JW DEBUG] Ad paused due to ad click"),t.pause());var n=this.adsLoaderManager.adEventObject(i);this.trigger("adClick",n),this.pausedByViewable=!1},t.prototype.adPaused=function(e){this.paused||(this.paused=!0,this.triggerAdPlay(e.getAd(),"adPause","paused",s))},t.prototype.adResumed=function(e){this.paused&&(this.paused=!1,this.triggerAdPlay(e.getAd(),"adPlay",s,"paused"))},t.prototype.adSkipped=function(e){this.debugConsoleLog("[JW DEBUG] AdSkipped"),this.adsLoaderManager.unbindEvents(["COMPLETE","VOLUME_CHANGED"]),this.finishAd();var t=this.adsLoaderManager.adEventObject(e.getAd());this.trigger("adSkipped",t)},t.prototype.adUserClose=function(e){this.debugConsoleLog("[JW DEBUG] AdUserClose"),this.currentAd&&this.currentAd.isLinear()&&-1===this.currentAd.getDuration()?this.adSkipped(e):(this.adsLoaderManager.unbindEvents(["COMPLETE","VOLUME_CHANGED"]),this.finishAd())},t.prototype.allAdsCompleted=function(){this.resumeRequested(),this.view.adTakeDown(),this.stopAdsManager()},t.prototype.stopAdsManager=function(){var e=this;this.initAdsManagerPromise.then(function(t){e.destroyed()||(e.debugConsoleLog("[JW DEBUG] Stop IMA SDK adsManager"),t.stop(),t.destroy(),e.initAdsManagerPromise=null,e.bidsPromise=null)}).catch(this.utils.noop)},t.prototype.adLog=function(e){this.debugConsoleLog("[JW DEBUG]",e.type,e);var t=e.getAdData();if(t&&t.adError){var i=this.adsLoaderManager.adErrorEventObject(t.adError,e);402===i.code?this.handleAdError(t.adError,i):(Ae(i,null,this),this.trigger(g,i))}},t.prototype.adError=function(e){var t=e.getError();this.handleAdError(t,e)},t.prototype.asyncError=function(e){var t=this;if(!this.destroyed())if(clearTimeout(this.timeoutAdStart),this.timeoutAdStart=setTimeout(function(){return t.destroy()},0),e&&e.getError){var i=e.getError();this.handleAdError(i,e,!0)}else e.target&&e.target.src?console.error("Failed to load "+e.target.src):console.error(e)},t.prototype.handleAdError=function(e,t,i){var r=this;this.options.debug&&console.error(e),900===e.getErrorCode()||i?(clearTimeout(this.timeoutAdStart),this.timeoutAdStart=setTimeout(function(){return r.destroy()},0)):(this.stopBlocking(),this.view.adTakeDown());var n=this.adsLoaderManager.adErrorEventObject(e,t),o=t.getAd?t.getAd():null;Ae(n,o?o.getWrapperAdSystems():[],this),this.player&&0===this.player.getPosition()&&(this._qoe.tick("adError"),n.timeLoading=this._qoe.between("adBeforePlay","adError")),this.trigger(g,n)},t.prototype.destroy=function(){if(this.debugConsoleLog("[JW DEBUG] JW Player destroy PlaylistItemManager"),this.off(),!this.destroyed()){this.player.off(null,null,this),this.bids.map(function(e){e.stop()}),this.bids=[],clearTimeout(this.timeoutAdStart),clearInterval(this.progressIntervalId),this.currentAd=null,this.options=null,this.video=null,this.initAdsManagerPromise=null,this.bidsPromise=null;var e=this.adsLoaderManager;e&&(e.reset(),this.adsLoaderManager=null),this.blockingInstreamPlayer&&this.stopBlocking(),this.instreamProvider.off(),this.instreamProvider.setProxy(null),this.instreamProvider=null,this.view.adTakeDown(),this.view=null,this.player=null,this.item=null}},t.prototype.destroyed=function(){return!this.item},t}();function Pe(e){try{return e.getAdPodInfo()}catch(e){return null}}var Ce=function(){function t(e){f(this,t),this.adsLoader=null,this.adDisplayContainer=null,this.displayInitialized=!1,this.adsRequest=null,this.userRequestContext=null,this.adsManager=null,this.adsManagerEvents={},this.container=e,this.adIds={},this.schedule=null,this.tagMap={},this.playerApi=null,this.video=null}return t.prototype.getVpaidMode=function(e){var t=google.ima.ImaSdkSettings.VpaidMode;return"disabled"===e||"none"===e?t.DISABLED:"enabled"===e?t.ENABLED:t.INSECURE},t.prototype.initializeDisplay=function(e){this.adDisplayContainer&&!this.displayInitialized&&(this.adDisplayContainer.initialize(),e&&e.restrict&&(this.displayInitialized=!0))},t.prototype.contentComplete=function(){if(null!==this.adsRequest){var e=this.adsLoader;e&&e.contentComplete(),this.adsRequest=null}},t.prototype.reset=function(){this.userRequestContext=null;var e=this.adsManager;e&&(e.destroy(),this.adsManager=null),this.contentComplete(!0),this.schedule=null,this.adsManagerEvents={},this.adIds={},this.tagMap={}},t.prototype.prepare=function(e){google.ima.settings.setDisableCustomPlaybackForIOS10Plus(!0);var t=this.adsLoader;return t||(this.video=e,this.adDisplayContainer=new google.ima.AdDisplayContainer(this.container,this.video),t=this.adsLoader=new google.ima.AdsLoader(this.adDisplayContainer)),t},t.prototype.open=function(e,t,i,r,n){t.locale&&google.ima.settings.setLocale(t.locale),t.maxRedirects>=0&&google.ima.settings.setNumRedirects(t.maxRedirects);var o=this.prepare(n);this.playerApi=i;var a={requestType:e,vpaidMode:t.vpaidmode,playerVersion:i.version.split("+")[0]};this.userRequestContext=a;var s=t.getSchedule();if(!s)return Promise.reject();var d=new google.ima.AdsRequest,l=i.getSafeRegion(!1);d.linearAdSlotWidth=l.width,d.linearAdSlotHeight=l.height;var u=i.getSafeRegion(!0);d.nonLinearAdSlotWidth=u.width,d.nonLinearAdSlotHeight=u.height,d.forceNonLinearFullSlot=r.forceNonLinearFullSlot,d.vastLoadTimeout=r.vastLoadTimeout,this.adsRequest=d;var g=new w(i,r);if("object"==typeof s){var c=g.getTagList(s);1===c.length&&0===c[0].offset&&(s=c[0].tag)}return"string"==typeof s?s=d.adTagUrl=a.adTagUrl=h(s,i,r):(d.adsResponse=a.adsResponse=g.getAdsResponse(s),this.tagMap=g.getTagMap(s)),this.schedule=s,new Promise(function(e,t){o.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,t,!1),o.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,e,!1)})},t.prototype.requestAds=function(){this.adsRequest.setAdWillAutoPlay(this.playerApi.getConfig().autostart),this.adsRequest.setAdWillPlayMuted(this.playerApi.getMute());var e=this.adsLoader,t=this.userRequestContext,i=this.getVpaidMode(t.vpaidMode),r=e.getSettings();r.setPlayerType("jwplayer"),r.setPlayerVersion(t.playerVersion),r.setVpaidMode(i),e.requestAds(this.adsRequest,t)},t.prototype.getAdsManager=function(e,t,i){var r=new google.ima.AdsRenderingSettings;return r.loadVideoTimeout=i.loadVideoTimeout,r.enablePreloading=i.enablePreloading,r.uiElements=null,r.autoAlign=!0,r.useStyledNonLinearAds=!0,this.adsManager=e.getAdsManager(t,r),this.userRequestContext=e.getUserRequestContext(),this.adsManager},t.prototype.bindEvents=function(e){var t=this,i=google.ima.AdEvent.Type,r=google.ima.AdErrorEvent.Type;Object.keys(e).forEach(function(n){var o=i[n]||r[n],a=t.adsManagerEvents[o];a&&t.adsManager.removeEventListener(o,a),t.adsManager.addEventListener(o,e[n],!1),t.adsManagerEvents[o]=e[n]})},t.prototype.unbindEvents=function(e){var t=this,i=google.ima.AdEvent.Type,r=google.ima.AdErrorEvent.Type;e.forEach(function(e){var n=i[e]||r[e],o=t.adsManagerEvents[n];o&&(t.adsManager.removeEventListener(n,o),delete t.adsManagerEvents[n])})},t.prototype.getAdId=function(e){if(e){var t=e.getAdId(),i=Pe(e);if(i&&(t=""+i.getTimeOffset()),t)return void 0===this.adIds[t]&&(this.adIds[t]=(n=12,new Array(n+1).join((Math.random().toString(36)+"00000000000000000").slice(2,18)).slice(0,n))),this.adIds[t]}var n;return r},t.prototype.getTag=function(e,t){if("string"==typeof this.schedule)return this.schedule;var i=Pe(e);if(i){var r=this.tagMap[i.getTimeOffset()];if(r)return r}var n=this.userRequestContext;return t&&t.getUserRequestContext&&(n=t.getUserRequestContext()||n),n?n.adTagUrl||n.adsResponse||"":(console.error("invalid request context",n),"")},t.prototype.adEventObject=function(t){var i={client:e,tag:this.getTag(t),ima:{ad:t,userRequestContext:this.userRequestContext}};if(!t)return i;i.id=this.getAdId(t),i.adtitle=t.getTitle(),i.adsystem=t.getAdSystem(),i.creativetype=t.getContentType(),i.linear=t.isLinear()?"linear":"nonlinear",i.viewable=this.playerApi.getViewable();var r=Pe(t);if(r){var n=r.getTotalAds();n>1&&(i.sequence=r.getAdPosition(),i.podcount=n);var o=r.getTimeOffset(),a="mid";0===o?a="pre":-1===o&&(a="post"),i.adposition=a}return i},t.prototype.adErrorEventObject=function(t,i){var n=t.getMessage&&t.getMessage()||t.message,o=t.getVastErrorCode&&t.getVastErrorCode()||900,a=t.getErrorCode&&t.getErrorCode()||900;a<1e4&&(a+=2e4);var s=this.getTag(i.getAd&&i.getAd(),i);return{id:r,client:e,message:"Ad Error: "+n,code:o,adErrorCode:a,tag:s}},t}();!function(e){if(e&&"undefined"!=typeof window){var t=document.createElement("style");t.setAttribute("media","screen"),t.innerHTML=e,document.head.appendChild(t)}}(".jwplayer.jw-flag-ads-googleima.jw-flag-small-player.jw-flag-ads.jw-state-playing.jw-flag-touch:not(.jw-flag-ads-vpaid) .jw-controls .jw-controlbar,.jwplayer.jw-flag-ads-googleima.jw-flag-touch .jw-display-icon-display,.jwplayer.jw-flag-ads-googleima.jw-flag-touch .jw-display-icon-display .jw-icon-display{pointer-events:none}.jwplayer.jw-flag-ads-googleima .jw-controls-backdrop,.jwplayer.jw-flag-ads-googleima.jw-flag-small-player .jw-icon-fullscreen{display:none}.jwplayer.jw-flag-ads-googleima.jw-flag-touch .jw-controlbar{font-size:1em}.jwplayer.jw-flag-ads-googleima .jw-controlbar{background:0 0!important;pointer-events:none}.jwplayer.jw-flag-ads-googleima.jw-ie .jw-slider-volume,.jwplayer.jw-flag-ads-googleima.jw-ie .jw-svg-icon{background:rgba(0,0,0,.25);border-radius:3px}.jwplayer.jw-flag-ads-googleima.jw-ie .jw-slider-volume{margin:0 10px}@supports (filter:drop-shadow(0 0 3px #000)){.jwplayer.jw-flag-ads-googleima.jw-ie .jw-slider-volume,.jwplayer.jw-flag-ads-googleima.jw-ie .jw-svg-icon{background:0 0;border-radius:0}.jwplayer.jw-flag-ads-googleima.jw-ie .jw-slider-volume{margin:0}}.jwplayer.jw-flag-ads-googleima .jw-svg-icon{fill:#fff;filter:drop-shadow(0 0 3px #000)}.jwplayer.jw-flag-ads-googleima .jw-spacer,.jwplayer.jw-flag-ads-googleima .jw-text{order:1}.jwplayer.jw-flag-ads-googleima .jw-text{text-shadow:0 0 3px #000}.jwplayer.jw-flag-ads-googleima.jw-flag-small-player .jw-controlbar{flex-flow:column-reverse nowrap;height:100%;max-height:none}.jwplayer.jw-flag-ads-googleima.jw-flag-small-player .jw-button-container{align-items:flex-end;flex-wrap:wrap;margin-bottom:7px}.jwplayer.jw-flag-ads-googleima.jw-flag-small-player .jw-controlbar .jw-icon{height:30px}.jwplayer.jw-flag-ads-googleima.jw-flag-small-player .jw-text{align-self:flex-start;margin:16px 0 0 16px;order:-1;width:100%}");(window.jwplayerPluginJsonp||window.jwplayer().registerPlugin)(e,"8.1",function(n,o,a){var s=this,d=n.utils,l=n.getConfig(),h=new P(o||{},d),f=null,m=void 0,y=0;if(h.premiumAds){if(n.getMute()||l.autostart)return console.log("Premium Ads: Cannot play ads in autostart or muted"),void(this.destroy&&this.destroy());if(function(){var e=(window.performance||{}).timing;if(e){var t=e.loadEventEnd||(new Date).getTime(),i=t-e.navigationStart;if(i>0)return i}return p}()>=p)return console.log("Premium Ads: Page load took too long to start an ad"),void(this.destroy&&this.destroy())}M(d).then(function(){if(m){var e=j();e>=0&&e-m>=p&&(console.log("Premium Ads: IMA SDK load took too long to start an ad"),s.destroy&&s.destroy())}}).catch(d.noop);var v=n._,b=l.key;d.addClass(a,"jw-plugin-googima");var w=new C(a,n.id,d.style),A=new k(d,n.Events,w),E=new Ce(w.getAdDiv()),_=null;this.version="8.2.9",n.utils.extend(this,n.Events);function L(e,t,i,r){try{return e.getCompanionAds(t,i,r)}catch(e){return[]}}function S(e){var t=new google.ima.CompanionAdSelectionSettings;t.sizeCriteria=google.ima.CompanionAdSelectionSettings.SizeCriteria.IGNORE;var i=h.companiondiv||{width:300,height:250},r=function(e){for(var t=[],i=0;i<e.length;i++){var r=e[i];t.push({width:r.getWidth(),height:r.getHeight(),type:"html",resource:r.getContent(),click:null})}return t}(L(e,i.width,i.height,t)),o=r.length;if(o){var a=_.adsLoaderManager.adEventObject(e);a.companions=r,n.trigger(u,a)}if(h.companiondiv){t=new google.ima.CompanionAdSelectionSettings,h.companionResourceType&&(t.resourceType=google.ima.CompanionAdSelectionSettings.ResourceType[h.companionResourceType]);var s=L(e,h.companiondiv.width,h.companiondiv.height,t);o=Math.max(o,s.length),function(e){if(e&&e.length){var t=document.getElementById(h.companiondiv.id);if(t){var i=e[0];i&&(v.isFunction(i.getContent)?t.innerHTML=i.getContent():t.innerHTML=i.resource||i.content)}}}(s)}return o>0}function I(){_&&!_.destroyed()&&(n.off(null,null,_),_.destroy(),_=null)}function R(e){_&&_.discardAdBreak(),E.contentComplete(),I(),e&&e.adschedule?h.adschedule=e.adschedule:h.adschedule=null,n.setCues([])}function D(e,t,r){var o=this,a=e.item||{};R(a),t!==i||function(){var e=h.getAdRules(),t=0===e.frequency&&1===y,i=y>=e.startOn&&(y-e.startOn)%e.frequency==0;return t||i}()?(f||(f=n.createInstream().getMediaElement()),r.getSchedule()?(E.reset(),(_=new Ee(a,h,n,A,w,E,f)).on("all",function(e,t){return n.trigger(e,t)}),_.init(t,r),_.on(c,function(e){S(e.ima.ad)}),n.once("beforePlay",function(e){if(h.premiumAds){var t=n.getHeight(),i=n.getWidth();if(t<270||i<480)return console.log("Premium Ads: Player size is smaller than 480x270 to play an ad"),void o.destroy();j()<0&&(m=Date.now())}_.beforePlay(e)},_).on("beforeComplete",function(){return _.beforeComplete()},_).on("time",function(e){return _.time(e)},_).on("resize",function(){return _.resize()},_).on("fullscreen",function(){return _.resize()},_)):M(d).then(function(){E.prepare(f)}).catch(d.noop)):h.adschedule=null}n.pauseAd=function(e){_&&(e?_.pause():_.resume())},n.playAd=function(e){var i=d.extend({},o,{debug:h.debug});delete i.ad,delete i.tag,delete i.schedule,n._.isArray(e)?i.tag=e[0]:i.tag=e;var r=new P(i,d),a=_?_.blockingInstreamPlayer:null;a&&(a.noResume=!0),D({},t,r),_&&_.beforePlay(null)},n.on("ready",function(){M().catch(function(e){e.message.match(/Failed to load/)&&O("Ad playback blocked by an ad blocker",2e4)}),x.catch(function(e){O("Ad Error: "+e.message,60002)});var e=document.body,t=function(){e.removeEventListener("mouseup",t),e.removeEventListener("touchend",t),E.initializeDisplay()};e.addEventListener("mouseup",t,!1),e.addEventListener("touchend",t,!1)},this).on("playlistItem",function(e){y++,D(e,i,h)},this).on("playlistComplete",function(){R()},this).on("cast",function(e){e.active&&R()},this).on("mute",function(e){var t=e.mute;A.mute(t)}).on("destroyPlugin",function(){s.destroy()},this);var x=T.call(this,d,b);x.catch(d.noop);var O=function(t,i){I(),n.off(null,null,s),n.playAd=d.noop,n.trigger(g,{id:r,client:e,message:t,code:900,adErrorCode:i,tag:""})};this.destroy=I,this.adsDebugMode=function(){h.debug=!0,_&&(_.debugConsoleLog=function(){var e;(e=console).log.apply(e,arguments)})}})}();
